<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Login</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css" />

</head>

<body>
    <div class="container">
        <nav id="userInfo">

        </nav>
        <form id="loginInfo">
            <input id="username" placeholder="username"> </input>
            <input id="email" placeholder="email address"> </input>
            <input id="password" placeholder="password"> </input>
            <button class="submitLogin" type="submit">Login</button>
        </form>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/home.js"></script>
    <script type="text/javascript">

  // Getting jQuery references to the post email, username, form, and password
  var usernameInput = $("#username");
  var emailInput = $("#email");
  var passwordInput = $("#password");
  var loginForm = $("#loginInfo");
  var loggedUser;
  // Adding an event listener for when the form is submitted
  $(loginForm).on("submit", function handleFormSubmit(event) {
    event.preventDefault();
    // Wont submit the post if we are missing any fields
    if (!usernameInput.val().trim() || !passwordInput.val().trim() || !emailInput.val().trim()) {
      alert("please fill in all fields");
        return;
    }
    // Constructing a newLogin object to hand to the database
    var newLogin = {
      email: emailInput.val().trim(),
      username: usernameInput.val().trim(),
      password: passwordInput.val()
    };

    console.log(newLogin);
    submitPost(newLogin);
    findUser(newLogin);
});


  // Submits a new post
  function submitPost(Login) {
    $.post("/api/login/", Login, function() {
    });
  }

  function findUser(Login) {
    $.get("/api/login/", Login, function(data) {
        for(var i=0;i<data.length;i++){
            if((data[i].username === Login.username) && (data[i].password === Login.password)){
                console.log("Found");
                $("#userInfo").text(Login.username);
            }
        }
        
    });
  }
    </script>
</body>

</html>